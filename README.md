# Timeliness-aware Fair Recommendation (TaFR)

This is the Repo for the paper:

Jiayin Wang, Weizhi Ma, Chumeng Jiang, Min Zhang, Yuan Zhang, Biao Li and Peng Jiang, 2023. Measuring Item Global Residual Value for Fair Recommendation. In SIGIR'23.

Currently under constructions.


## Reference
```
@inproceedings{DBLP:conf/SIGIR/WangMJZYLJ23,
  author    = {Jiayin Wang and
               Weizhi Ma and
               Chumeng Jiang and
               Min Zhang and
               Zhang Yuan and
               Biao Li and
               Peng Jiang},
  title     = {Measuring Item Global Residual Value for Fair Recommendation},
  booktitle = {{SIGIR} '23: Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval},
  doi       = {10.1145/3539618.3591724}
}
```

For inquiries, contact Jiayin Wang (JiayinWangTHU AT gmail.com).


# Explanation of `itemHourLog.csv`

## **1. What is `itemHourLog.csv`?**
`itemHourLog.csv` is a dataset that aggregates interactions with items (e.g., news articles) at an hourly level. It provides insights into user engagement with items over time. This file is often used in recommender systems or survival analysis tasks to model the performance and popularity of items.

---

## **2. Columns in `itemHourLog.csv`**
The file has the following columns:

| **Column**      | **Description**                                                                 |
|------------------|---------------------------------------------------------------------------------|
| `photo_id`       | A unique identifier for each item (mapped from the `news_id` in `news.tsv`).   |
| `timelevel`      | The rounded hour during which interactions occurred (e.g., `2023-01-01 12:00`).|
| `exposure`       | Total number of times the item was exposed to users in the given hour.         |
| `clicks`         | Total number of clicks the item received in the given hour.                   |
| `click_rate`     | The proportion of clicks relative to exposures (`clicks / exposure`).          |
| `play_rate`      | A proxy metric for user engagement, calculated as the ratio of `play_time` to `photo_time`. |
| `new_pctr`       | A proxy for predicted click-through rate (CTR), approximated by `click_rate`.  |
| `photo_time`     | Simulated total duration of the content (e.g., video length).                 |
| `play_time`      | Simulated total time users spent engaging with the content.                   |

---

## **3. How Did You Discover the Columns?**

The columns were derived from the requirements of recommender system datasets and survival analysis tasks. Here's the reasoning for each column:

- **`photo_id` and `timelevel`:** These are the identifiers for items and their interaction times. These columns are standard in time-series interaction data.
- **`exposure` and `clicks`:** Extracted from `behaviors.tsv`, which lists the items shown to users (`exposure`) and the ones they clicked on (`clicks`).
- **`click_rate`:** A commonly used metric in recommender systems to evaluate item performance.
- **`play_rate` and `new_pctr`:** Placeholders for advanced engagement metrics (e.g., estimated from machine learning models or domain-specific logic).

---

## **4. How Were the Values Generated?**

### **`photo_id`**
- Generated by mapping `news_id` from `news.tsv` to a sequential integer ID. 
- Each `news_id` (e.g., `N88753`) was assigned a unique `photo_id` (e.g., 1, 2, 3, ...).

### **`timelevel`**
- Extracted from the `time` column in `behaviors.tsv` by rounding to the nearest hour using `pd.to_datetime(behaviors["time"]).dt.floor("h")`.

### **`exposure`**
- Counted as the total number of items shown to users in the `impression_list` column of `behaviors.tsv`. Each item in the list is counted as an exposure.

### **`clicks`**
- Counted as the number of items in `impression_list` that have the suffix `-1`, indicating a click.

### **`click_rate`**
- Computed as:
  \[
  \text{click\_rate} = \frac{\text{clicks}}{\text{exposure}}
  \]
  Where a division by zero is handled by setting `click_rate` to 0 for rows with `exposure = 0`.

### **`photo_time`**
- Simulated using random uniform values, assuming content durations range from 30 to 300 seconds.

### **`play_time`**
- Simulated using the number of clicks multiplied by random uniform engagement times (e.g., 10 to 30 seconds).

### **`play_rate`**
- Computed as:
  \[
  \text{play\_rate} = \frac{\text{play\_time}}{\text{photo\_time}}
  \]
  Values are clipped to ensure `play_rate <= 1`.

### **`new_pctr`**
- Set equal to `click_rate`, serving as a simple proxy for predicted CTR.

---

## **5. Why Use Simulated Values for `play_time` and `photo_time`?**

- If `play_time` and `photo_time` are not explicitly available in the dataset, simulation provides a reasonable proxy for modeling user engagement.
- These simulated values can later be replaced with real metrics if available or derived using machine learning models.

---

## **Summary**
- **Purpose:** `itemHourLog.csv` aggregates item interactions at an hourly level for analysis and modeling.
- **Columns:** Designed based on standard metrics in recommender systems (e.g., `exposure`, `clicks`, `click_rate`) and additional engagement metrics (`play_rate`, `new_pctr`).
- **Values:** Derived from `behaviors.tsv` and `news.tsv`, with simulated placeholders for missing data.

